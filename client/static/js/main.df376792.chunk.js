(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,t){e.exports="data:image/gif;base64,R0lGODlh+gD6AMQdALKysmtra8XFxezs7NnZ2YqKitTU1K6urvr6+s/Pz/Hx8fX19be3t/T09Jubm7y8vOfn59/f393d3XJycsrKyunp6cDAwHp6era2tuLi4oKCgqWlpZOTk////wAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTExIDc5LjE1ODMyNSwgMjAxNS8wOS8xMC0wMToxMDoyMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RTA4OUYxNzlCOTVBMTFFNUExQkVBRTQ2QUVBREI4QkYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RTA4OUYxN0FCOTVBMTFFNUExQkVBRTQ2QUVBREI4QkYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFMDg5RjE3N0I5NUExMUU1QTFCRUFFNDZBRUFEQjhCRiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFMDg5RjE3OEI5NUExMUU1QTFCRUFFNDZBRUFEQjhCRiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAUZAB0ALAAAAAD6APoAAAX/YCeOZGmeaKqubOu+cCzPdG3feK7vfO//wKBwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweEwum8/otHrNbrvf8Lh8Tq/b7/i8fs/v+/+AgYKDhIWGh4iJiouMjY6PkJGSk5SVlpeYmZqbnJ2en6ChoqOkpaanqKmqq6ytrq+wsbKztLW2t7i5uru8vb6/wMHCw8TFxsfIycrLzM3Oz9DR0tPU1dbX2Nna29zd3t/g4eLj5OXm5+jp6uvs7e7v8PHy8/T19vf4+fr7/P3+/wADChxIsKDBgwgTKlzIsKHDhxAjcqvgoIDFixYdGDgxIIGAjyA/JljAkULIkAYQ/5yLMCGAy5cwA1AoAQGAzZs4ATBQUCJDzp8MSJYrELNogAslHvz8KYAEgqU/E5gzarTCiAVQf5IYkBVn03JUi24UwbXrza1mbX4lFzbm2A5l06JNu3ZcW5hv45qda7auuLsv86a1yber33CAXQoeXDjrYXCJAyyWO0Kv46mJJ++tPPjxt5aAG4x4mpZBY6ievTkAXKCEgLRSSSg1S8BcA6JhNYh2asGwShIKZkONvRLDgePID7w1MYCA8+cEJPA8gQAC9OfSJWrfzr279+/gw4sfT768+fPo06tfz769+/fw48ufT7++/fv48+vfz7+///8ABijggAQWaOCBCCao4EKCDDbo4IMQRijhhBRWaOGFGGao4YYcdujhhyCGKOKIJJZo4okopqjiiiy26OKLMMYo44w01mjjjTjmqOOOPPboSAgAIfkEBRkAHQAsYgB1ACEADwAABXtgtyRCaZbJ0K1sZzhFLMdO1SkMoO88ALUdSmBILAYmEUFvCXgAL8ZooMBkLlgVqbS6VK0M2ii353WFjWNeGXwmpnfrtvsNiMsD9DqLLc/b5TlvCCwNdxMJbwJABXIOCEpcFoMtDRpnBQ0rChIEnZ4EZUAuB6SlBxgRKyEAIfkEBRkAHQAsdAB1ACIADwAABX5g1w2JYJ5msoisaHBFLMdbI0JAru8Ao7QdS2BILAYmlc6DxwQIWg2jdOhYNJstw1RaGFyZ2a2x++WFxURyWXdGB9RrQBsNX8/F9fJ9m//upwUIcT1/XB0CcQlAF24BBx0IFmUCCEARjGIOLQMEnZ4EEj9AIg0UB6eoBxgRIiEAOw=="},19:function(e,t,n){e.exports=n(34)},31:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),s=n(18),r=n.n(s),c=n(11),i=n(4),l=n(5),u=n(7),m=n(6),p=n(8),d=n(35),h=n(13),g=n.n(h),f=function(e){function t(){var e,n;Object(i.a)(this,t);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).upvote=function(){n.props.user._id?fetch("/api/post/".concat(n.props.post._id,"/upvote"),{method:"PUT",headers:{Authorization:"Bearer "+n.props.token,"Content-Type":"application/json"},body:JSON.stringify({userId:n.props.user._id})}).then(function(e){return e.json()}).then(function(e){e.success?(n.props.updateUser(e),n.props.single&&n.props.updatePostAfterVotes(e.post)):console.log(e.message)}).catch(function(e){console.log(e)}):console.log("You are not logged in!")},n.downvote=function(){n.props.user._id?fetch("/api/post/".concat(n.props.post._id,"/downvote"),{method:"PUT",headers:{Authorization:"Bearer "+n.props.token,"Content-Type":"application/json"},body:JSON.stringify({userId:n.props.user._id})}).then(function(e){return e.json()}).then(function(e){e.success?(n.props.updateUser(e),n.props.single&&n.props.updatePostAfterVotes(e.post)):console.log(e.message)}).catch(function(e){console.log(e)}):console.log("You are not logged in!")},n.deletePost=function(e,t){n.props.user._id?fetch("/api/post/".concat(t,"/delete"),{method:"DELETE",headers:{Authorization:"Bearer "+n.props.token,"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){e.success?n.props.deletePost(e):console.log(e.message)}).catch(function(e){console.log(e)}):console.log("You are not logged in!")},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.post,n=t.title,s=t.text,r=t.created,c=t.username,i=t.upvotedby,l=t.downvotedby,u=t.score,m=t.author,p=t._id;return a.a.createElement(o.Fragment,null,a.a.createElement("div",{className:"post"},a.a.createElement("div",{className:"rank"},this.props.rank),a.a.createElement("div",{className:"votes"},a.a.createElement("div",{className:"arrow up ".concat(this.props.user&&i.includes(this.props.user._id)?"upvoted":""),onClick:function(){return e.upvote(e.props.user,p)}}),a.a.createElement("div",{className:"score"},u||0),a.a.createElement("div",{className:"arrow down ".concat(this.props.user&&l.includes(this.props.user._id)?"downvoted":""),onClick:function(){return e.downvote(e.props.user,p)}})),a.a.createElement(d.a,{to:"/post/".concat(p),className:"thumbnail self"}),a.a.createElement("div",{className:"content"},a.a.createElement("div",{className:"title-area"},a.a.createElement("span",{className:"title"},this.props.single?a.a.createElement("span",null,n):a.a.createElement(d.a,{to:"/post/".concat(p)},n)),a.a.createElement("span",{className:"url"},"(self.subreddit)")),a.a.createElement("div",{className:"meta-area"},"Submitted ",g()(r).fromNow()," by"," ",a.a.createElement(d.a,{to:"/user/".concat(c)},c)),a.a.createElement("div",{className:"link-area"},m==this.props.user._id||this.props.user.isAdmin?a.a.createElement("a",{onClick:function(){return e.deletePost(e.props.user,p)},className:"fake-link"},"delete"):""))),this.props.single&&s?a.a.createElement("div",{className:"post-text"},s):"")}}]),t}(o.Component),E=n(14),v=n.n(E),b=function(e){function t(){var e,n;Object(i.a)(this,t);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).loadMorePosts=function(){n.props.getNextPosts()},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return this.props.loading?a.a.createElement("div",{className:"center"},a.a.createElement("img",{src:v.a,alt:"Loading animation"})):a.a.createElement("div",null,this.props.posts.map(function(t,n){return a.a.createElement(f,{key:n,user:e.props.user,token:e.props.token,updateUser:e.props.updateUser,deletePost:e.props.deletePost,post:t,rank:n+1})}),this.props.loadMore?a.a.createElement("div",{className:"pagination center"},a.a.createElement("span",{onClick:this.loadMorePosts,className:"load-more"},"Load more")):"")}}]),t}(o.Component),y=function(e){function t(){var e,n;Object(i.a)(this,t);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).state={submit:!1,submitMessage:"Submitting..."},n.processPost=function(e){n.setState({submit:!0}),e.preventDefault();var t={};t.title=e.target.title.value,t.text=e.target.text.value,t.created=Date.now(),t.author=n.props.user._id,t.username=n.props.user.username,t.title&&fetch("/api/posts/new",{method:"POST",headers:{Authorization:"Bearer "+n.props.token,"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(e){e.success?(n.props.submitPost(e),n.props.history.push("/post/".concat(e.post._id))):e.tokenExpired?n.props.tokenExpired():n.setState({submit:!0,submitMessage:"Something went wrong, please contact the admin"})}).catch(function(e){n.setState({submit:!0,submitMessage:"The server encountered an error, please contact the admin"})})},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("h3",null,"Submit a new post"),a.a.createElement("form",{onSubmit:this.processPost,className:"submit-form",action:""},a.a.createElement("div",{className:"input-box"},a.a.createElement("label",{htmlFor:"title"},"title"),a.a.createElement("input",{name:"title",type:"text",required:!0})),a.a.createElement("div",{className:"input-box"},a.a.createElement("label",{htmlFor:"text"},"text (optional)"),a.a.createElement("textarea",{name:"text",id:"",rows:"6"})),a.a.createElement("button",null,"submit"),this.state.submit?a.a.createElement("span",null,a.a.createElement("small",null," ",this.state.submitMessage)):""))}}]),t}(o.Component),A=function(e){function t(){var e,n;Object(i.a)(this,t);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).upvote=function(){n.props.user._id?fetch("/api/comment/".concat(n.props.comment._id,"/upvote"),{method:"PUT",headers:{Authorization:"Bearer "+n.props.token,"Content-Type":"application/json"},body:JSON.stringify(n.props.user)}).then(function(e){return e.json()}).then(function(e){e.success?n.props.updateComment(e.comment):console.log(e.message)}).catch(function(e){console.log(e)}):console.log("You are not logged in!")},n.downvote=function(){n.props.user._id?fetch("/api/comment/".concat(n.props.comment._id,"/downvote"),{method:"PUT",headers:{Authorization:"Bearer "+n.props.token,"Content-Type":"application/json"},body:JSON.stringify(n.props.user)}).then(function(e){return e.json()}).then(function(e){e.success?n.props.updateComment(e.comment):console.log(e.message)}).catch(function(e){console.log(e)}):console.log("You are not logged in!")},n.deleteComment=function(){fetch("/api/post/".concat(n.props.comment._id,"/comment"),{method:"DELETE",headers:{Authorization:"Bearer "+n.props.token,"Content-Type":"application/json"},body:JSON.stringify(n.props.user)}).then(function(e){return e.json()}).then(function(e){e.success?(n.props.deleteComment(n.props.comment._id),console.log(e)):(e.tokenExpired,console.log(e))}).catch(function(e){console.log(e)})},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.comment,t=e.comment,n=e.author,o=e.username,s=e.created,r=e._id,c=e.upvotedby,i=e.downvotedby,l=e.score,u=this.props.user;return a.a.createElement("div",{className:"single-comment",id:"comment-id-".concat(r)},a.a.createElement("div",{className:"votes"},a.a.createElement("div",{className:"arrow up ".concat(u&&c.includes(u._id)?"upvoted":""),onClick:this.upvote}),a.a.createElement("div",{className:"arrow down ".concat(u&&i.includes(u._id)?"downvoted":""),onClick:this.downvote})),a.a.createElement("div",{className:"comment"},a.a.createElement("div",{className:"comment-author"},a.a.createElement("small",null,a.a.createElement(d.a,{to:"/user/".concat(o)},o)," ",l," points, posted ",g()(s).fromNow()," ",n==this.props.user._id||this.props.user.isAdmin?a.a.createElement("span",{className:"fake-link",onClick:this.deleteComment},"Delete"):"")),a.a.createElement("div",{className:"comment-body"},t),a.a.createElement("div",{className:"comment-meta"})))}}]),t}(o.Component),k=function(e){function t(){var e,n;Object(i.a)(this,t);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).state={post:null,comments:[],submit:!1,notFound:!1},n.deleteComment=function(e){var t=Object(c.a)(n.state.comments);t.forEach(function(n,o){n._id==e&&t.splice(o,1)}),n.setState({comments:t})},n.updatePostAfterVotes=function(e){n.setState({post:e})},n.updateComment=function(e){var t=Object(c.a)(n.state.comments);t.forEach(function(n,o){n._id===e._id&&(t[o]=e)}),n.setState({comments:t})},n.postComment=function(e){n.setState({submit:!0}),e.preventDefault();var t=e.target.comment.value;if(t){e.target.reset();var o=n.props.match.params.id,a={comment:t,author:n.props.user._id,username:n.props.user.username,post:o,upvotedby:n.props.user._id,created:Date.now()};fetch("/api/post/".concat(o,"/comment"),{method:"POST",headers:{Authorization:"Bearer "+n.props.token,"Content-Type":"application/json"},body:JSON.stringify(a)}).then(function(e){return e.json()}).then(function(e){if(e.success){var t=Object(c.a)(n.state.comments);t.push(e.comment),n.setState({comments:t,submit:!1}),n.props.history.push("#comment-id-".concat(e.comment._id))}else console.log(e),n.setState({submit:!1})}).catch(function(e){n.props.history.push("/?message=failed to post comment"),n.setState({submit:!1})})}else console.log("Comment is empty")},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;fetch("/api/post/".concat(t,"/single")).then(function(e){return e.json()}).then(function(t){t.success?e.setState({post:t.post,comments:t.comments}):(console.log(t),e.setState({notFound:!0,post:{}}))}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this;return this.state.post?this.state.notFound?a.a.createElement("div",null,a.a.createElement("h1",null,"Not Found")):a.a.createElement("div",null,a.a.createElement(f,{key:1,user:this.props.user,token:this.props.token,updateUser:this.props.updateUser,deletePost:this.props.deletePost,updatePostAfterVotes:this.updatePostAfterVotes,post:this.state.post,rank:1,single:!0}),a.a.createElement("div",{className:"comments"},this.state.comments.length&&this.state.comments.length>1?a.a.createElement("h3",null,"all ",this.state.comments.length," comments"):a.a.createElement("h3",null,this.state.comments.length," comments"),this.props.user&&this.props.user._id&&!this.props.user.banned?a.a.createElement("div",{className:"comment-form"},a.a.createElement("form",{onSubmit:this.postComment},a.a.createElement("textarea",{name:"comment",id:"",rows:"5",required:!0}),a.a.createElement("button",null,"Save")," ",this.state.submit?a.a.createElement("span",null," posting.."):"")):"",this.state.comments.map(function(t){return a.a.createElement(A,{token:e.props.token,user:e.props.user,comment:t,deleteComment:e.deleteComment,key:t._id,updateComment:e.updateComment})}))):a.a.createElement("div",{className:"center"},a.a.createElement("img",{src:v.a,alt:"Loading"}))}}]),t}(o.Component),w=function(e){function t(){var e,n;Object(i.a)(this,t);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).state={regError:!1,regErrorMsg:""},n.displayError=function(e){n.setState({regError:!0,regErrorMsg:e})},n.registerAccount=function(e){e.preventDefault();var t={};t.username=e.target.username.value.toLowerCase(),t.password=e.target.password.value,t.passwordConfirm=e.target.passwordConfirm.value,t.email=e.target.email.value,t.username&&t.password?fetch("/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(e){e.success?(n.props.register(e),n.props.history.push("/")):n.displayError(e.message)}).catch(function(e){n.displayError("There was a problem connecting to the server"),console.log(e)}):n.displayError("Required fields are missing")},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",null,a.a.createElement("div",{className:"reg-form"},a.a.createElement("h4",{className:"modal-title"},"Create a new account"),this.state.regError?a.a.createElement("div",{className:"reg-error"},this.state.regErrorMsg,a.a.createElement("div",{className:"close-button",onClick:function(){e.setState({regError:!1})}},"\xd7")):"",a.a.createElement("form",{onSubmit:this.registerAccount},a.a.createElement("input",{type:"text",name:"username",placeholder:"choose a username",required:!0}),a.a.createElement("input",{type:"password",name:"password",placeholder:"password",required:!0}),a.a.createElement("input",{type:"password",name:"passwordConfirm",placeholder:"verify password",required:!0}),a.a.createElement("input",{type:"email",name:"email",placeholder:"email",required:!0}),a.a.createElement("div",{className:"register-button-box"},a.a.createElement("button",{className:"button-primary"},"Sign Up")))))}}]),t}(o.Component),j=n(38),N=n(37),O=n(36),C=function(e){function t(){var e,n;Object(i.a)(this,t);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).state={posts:[],currentUser:{}},n.adminAction=function(e){n.props.user._id?fetch("/api/user/".concat(n.props.match.params.username,"/action/").concat(e),{method:"POST",headers:{Authorization:"Bearer "+n.props.token,"Content-Type":"application/json"},body:JSON.stringify({userId:n.props.user._id})}).then(function(e){return e.json()}).then(function(e){e.success?n.setState({currentUser:e.currentUser}):console.log("Something went wrong")}).catch(function(e){console.log(e)}):console.log("You are not logged in!")},n.deleteUser=function(){n.props.user._id?window.confirm("Are you sure you want to delete this user and all the posts created by them?")&&fetch("/api/user/".concat(n.props.match.params.username),{method:"DELETE",headers:{Authorization:"Bearer "+n.props.token,"Content-Type":"application/json"},body:JSON.stringify({userId:n.props.user._id})}).then(function(e){return e.json()}).then(function(e){e.success?(n.props.history.push("/"),console.log(e)):console.log(e)}).catch(function(e){console.log(e)}):console.log("You are not logged in!")},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("/api/user/".concat(this.props.match.params.username,"/posts")).then(function(e){return e.json()}).then(function(t){t.success?e.setState({posts:t.posts,currentUser:t.currentUser}):console.log(t)}).catch(function(e){return console.log(e)})}},{key:"render",value:function(){var e=this,t=this.props.match.params.username,n=this.state.currentUser,o=n.isAdmin,s=n.banned;return a.a.createElement("div",null,a.a.createElement("div",{className:"user-area"},a.a.createElement("h2",null,t),this.props.user.isAdmin&&this.state.currentUser&&this.props.user._id!==this.state.currentUser._id?a.a.createElement("div",{className:"admin-actions"},"Admin actions:"," ",s?a.a.createElement("button",{className:"load-more",onClick:function(){return e.adminAction("unban")}},"Unban User"):a.a.createElement("button",{className:"load-more red",onClick:function(){return e.adminAction("ban")}},"Ban User")," ",o?a.a.createElement("button",{className:"load-more",onClick:function(){return e.adminAction("removeadmin")}},"Remove Admin"):a.a.createElement("button",{className:"load-more",onClick:function(){return e.adminAction("makeadmin")}},"Make Admin")," ",a.a.createElement("button",{className:"load-more red",onClick:this.deleteUser},"Delete User")," "):""),this.state.posts.map(function(t,n){return a.a.createElement(f,{key:n,user:e.props.user,token:e.props.token,updateUser:e.props.updateUser,deletePost:e.props.deletePost,post:t,rank:n+1})}))}}]),t}(o.Component);function S(e){return a.a.createElement("div",{id:"layout"},e.children)}var I=function(e){function t(){var e,n;Object(i.a)(this,t);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).state={loading:!0,posts:[],user:{},token:"",loggedIn:!1,loginError:!1,loginMsg:"Something went wrong",currentPage:1,loadMore:!0},n.getNextPosts=function(){var e=Object(c.a)(n.state.posts);fetch("/api/posts/50/".concat(n.state.currentPage)).then(function(e){return e.json()}).then(function(t){t.posts.length?(t.posts.forEach(function(t){e.push(t)}),n.setState({posts:e,currentPage:n.state.currentPage+1}),console.log(t)):(console.log("End of the posts"),n.setState({loadMore:!1}))}).catch(function(e){return console.log(e)})},n.register=function(e){n.setState({loggedIn:!0,user:e.user,token:e.token});var t={loggedIn:!0,user:e.user,token:e.token};localStorage.setItem("userInfo",JSON.stringify(t))},n.tokenExpired=function(){n.logout()},n.login=function(e){e.preventDefault();var t={};t.username=e.target.username.value,t.password=e.target.password.value,t.username&&t.password?fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(e){if(e.success){n.setState({loggedIn:!0,user:e.user,token:e.token});var t={loggedIn:!0,user:e.user,token:e.token};localStorage.setItem("userInfo",JSON.stringify(t))}else n.setState({loginError:!0,loginMsg:e.message})}).catch(function(e){console.log(e),n.setState({loginError:!0,loginMsg:e})}):n.setState({loginError:!0,loginMsg:"Missing credentials"})},n.logout=function(){n.setState({loggedIn:!1,token:void 0,user:{}}),localStorage.removeItem("userInfo")},n.submitPost=function(e){var t=Object(c.a)(n.state.posts);t.push(e.post),n.setState({posts:t,user:e.user}),localStorage.setItem("posts",JSON.stringify(t))},n.updateUser=function(e){var t=Object(c.a)(n.state.posts);t.forEach(function(n,o){n._id==e.post._id&&(t[o]=e.post)}),n.setState({posts:t})},n.deletePost=function(e){var t=Object(c.a)(n.state.posts);t.forEach(function(n,o){n._id==e.deletedId&&t.splice(o,1)}),n.setState({posts:t})},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=JSON.parse(localStorage.getItem("userInfo"));t&&this.setState({loggedIn:!0,token:t.token,user:t.user}),fetch("/api/posts/all").then(function(e){return e.json()}).then(function(t){t.success?e.setState({posts:t.data,loading:!1}):(console.log("Cannot load the file"),e.setState({loading:!1}))}).catch(function(t){console.log(t),e.setState({loading:!1})})}},{key:"render",value:function(){var e=this;return a.a.createElement(j.a,null,a.a.createElement(S,null,a.a.createElement("header",{id:"header"},a.a.createElement("nav",{className:"top-menu"},"Home - Popular - All - Random"),a.a.createElement("div",{className:"main-header"},a.a.createElement(d.a,{to:"/",id:"header-img",className:"default-header"},"reddit clone"),a.a.createElement("div",{className:"tab-menu"}),a.a.createElement("div",{className:"user-header"},this.state.loggedIn?a.a.createElement("span",null,"Hello"," ",a.a.createElement(d.a,{className:"fake-link",to:"/user/".concat(this.state.user.username)},this.state.user.username)," ","|"," ",a.a.createElement("a",{className:"fake-link",onClick:this.logout},"logout")," "):a.a.createElement("span",null,"Want to join? ",a.a.createElement("a",{href:"#login"},"Log in")," or"," ",a.a.createElement(d.a,{to:"/register"},"sign up")," in seconds.")))),a.a.createElement("div",{id:"container"},a.a.createElement("main",{id:"body-submissions"},a.a.createElement(N.a,{exact:!0,path:"/",render:function(t){return a.a.createElement(b,Object.assign({loading:e.state.loading,user:e.state.user,posts:e.state.posts,token:e.state.token,updateUser:e.updateUser,deletePost:e.deletePost,getNextPosts:e.getNextPosts,currentPage:e.state.currentPage,loadMore:e.state.loadMore},t))}}),a.a.createElement(N.a,{path:"/submit",render:function(t){return e.state.loggedIn?a.a.createElement(y,Object.assign({user:e.state.user,token:e.state.token,tokenExpired:e.tokenExpired,submitPost:e.submitPost},t)):a.a.createElement(O.a,{to:"/"})}}),a.a.createElement(N.a,{exact:!0,path:"/user/:username",render:function(t){return a.a.createElement(C,Object.assign({user:e.state.user,posts:e.state.posts,token:e.state.token,updateUser:e.updateUser,deletePost:e.deletePost},t))}}),a.a.createElement(N.a,{exact:!0,path:"/post/:id",render:function(t){return a.a.createElement(k,Object.assign({user:e.state.user,token:e.state.token,updateUser:e.updateUser,deletePost:e.deletePost,posts:e.state.posts},t))}}),a.a.createElement(N.a,{path:"/register",render:function(t){return e.state.loggedIn?a.a.createElement(O.a,{to:"/"}):a.a.createElement(w,Object.assign({register:e.register},t))}})),a.a.createElement("aside",{id:"sidebar"},this.state.loggedIn?"":a.a.createElement("div",{className:"login-box",id:"login"},this.state.loginError?a.a.createElement("div",{className:"login-error"},this.state.loginMsg,a.a.createElement("div",{className:"close-button",onClick:function(){e.setState({loginError:!1})}},"\xd7")):"",a.a.createElement("form",{onSubmit:this.login},a.a.createElement("input",{className:"login-username",type:"text",name:"username",placeholder:"username",required:!0}),a.a.createElement("input",{className:"login-password",type:"password",name:"password",placeholder:"password",required:!0}),a.a.createElement("div",{className:"login-button-area"},a.a.createElement("a",{className:"login-reset-link",href:"/reset"},"reset password"),a.a.createElement("button",null,"login")))),this.state.loggedIn?a.a.createElement("div",{className:"submit-button"},a.a.createElement(d.a,{to:"/submit"},"Submit")):"")),a.a.createElement("footer",{className:"center",id:"footer"},a.a.createElement("div",{className:"copyright"}))))}}]),t}(o.Component);n(31),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(a.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[19,2,1]]]);
//# sourceMappingURL=main.df376792.chunk.js.map